<%- include('../partials/head') %>
<%- include('../partials/header') %>

<main class="flex-1 bg-background-light dark:bg-background-dark text-gray-800 dark:text-gray-200 transition-colors duration-300">
  <div class="mx-auto max-w-[900px] px-4 md:px-10 py-12">
    <div class="bg-white dark:bg-background-dark rounded-3xl border border-border-light dark:border-border-dark p-8 md:p-10">
      <div class="mb-8">
        <h1 class="text-3xl font-black text-gray-900 dark:text-white">Créer un nouveau mot de passe</h1>
        <p class="mt-2 text-gray-600 dark:text-gray-400">Choisis un nouveau mot de passe (minimum 6 caractères).</p>
      </div>

      <% if (errorMessage) { %>
        <div class="mb-6 rounded-2xl border border-red-200 bg-red-50 p-5 text-red-900">
          <div class="font-bold">Erreur</div>
          <div class="mt-1 text-sm"><%= errorMessage %></div>
        </div>
      <% } %>

      <% if (successMessage) { %>
        <div class="mb-6 rounded-2xl border border-green-200 bg-green-50 p-5 text-green-900">
          <div class="font-bold">OK</div>
          <div class="mt-1 text-sm"><%= successMessage %></div>
        </div>
      <% } %>

      <form action="/compte/reinitialiser-mot-de-passe" class="space-y-5 max-w-md" method="POST">
        <input name="token" type="hidden" value="<%= typeof token !== 'undefined' ? token : '' %>" />

        <div>
          <label class="block text-sm font-semibold text-gray-900 dark:text-gray-200 mb-2" for="newPassword">Nouveau mot de passe</label>
          <input class="w-full h-14 px-5 rounded-full border border-gray-200 dark:border-white/10 bg-white dark:bg-white/5 dark:text-white focus:ring-2 focus:ring-primary focus:border-primary outline-none transition-all placeholder:text-gray-400" id="newPassword" name="newPassword" placeholder="••••••••" required type="password" />
        </div>

        <div>
          <label class="block text-sm font-semibold text-gray-900 dark:text-gray-200 mb-2" for="confirmPassword">Confirmer le mot de passe</label>
          <input class="w-full h-14 px-5 rounded-full border border-gray-200 dark:border-white/10 bg-white dark:bg-white/5 dark:text-white focus:ring-2 focus:ring-primary focus:border-primary outline-none transition-all placeholder:text-gray-400" id="confirmPassword" name="confirmPassword" placeholder="••••••••" required type="password" />
        </div>

        <button class="w-full h-14 bg-primary hover:bg-primary/90 text-white font-bold rounded-full shadow-lg shadow-primary/20 transition-all flex items-center justify-center gap-2" type="submit">
          Mettre à jour
          <span class="material-symbols-outlined text-sm">lock_reset</span>
        </button>

        <% if (!dbConnected) { %>
          <div class="mt-2 rounded-2xl border border-amber-200 bg-amber-50 p-5 text-amber-900">
            <div class="font-bold">Mode démo</div>
            <div class="mt-1 text-sm">La base de données est indisponible : l’opération ne peut pas fonctionner.</div>
          </div>
        <% } %>

        <div class="pt-2">
          <a class="text-sm font-bold text-primary hover:underline" href="/compte/mot-de-passe-oublie">Refaire une demande</a>
        </div>
      </form>
    </div>
  </div>
</main>

<%- include('../partials/footer') %>
