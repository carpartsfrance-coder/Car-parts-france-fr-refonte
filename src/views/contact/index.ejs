<%- include('../partials/head') %>
<%- include('../partials/header') %>

<main class="flex-1 bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-100 transition-colors duration-300">
  <div class="mx-auto max-w-[1440px] px-4 md:px-10 py-10">
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 items-start">
      <div class="lg:col-span-5">
        <div class="rounded-3xl bg-white/80 dark:bg-surface-dark/70 backdrop-blur border border-slate-100 dark:border-slate-800 p-6 sm:p-8 shadow-premium">
          <div class="flex items-center gap-3">
            <div class="h-12 w-12 rounded-2xl bg-primary/10 flex items-center justify-center">
              <span class="material-symbols-rounded text-primary text-3xl">support_agent</span>
            </div>
            <div>
              <div class="text-xs font-black uppercase tracking-widest text-slate-400">CarParts France</div>
              <h1 class="text-2xl sm:text-3xl font-black tracking-tight">
                <%= mode === 'devis' ? 'Demande de devis' : 'Contact' %>
              </h1>
            </div>
          </div>

          <p class="mt-4 text-sm text-slate-600 dark:text-slate-300 leading-relaxed">
            <%= mode === 'devis'
              ? "Dis-nous ce qu’il te faut (référence, VIN, véhicule) et on te répond rapidement avec la bonne pièce et le bon prix."
              : "Une question ? Besoin d’aide pour une référence ou une compatibilité ? Écris-nous, on te répond rapidement." %>
          </p>

          <div class="mt-6 flex flex-col sm:flex-row flex-wrap gap-3">
            <a class="inline-flex items-center justify-center gap-2 rounded-2xl bg-white hover:bg-slate-50 dark:bg-slate-900 dark:hover:bg-slate-800 border border-slate-200 dark:border-slate-700 px-4 py-3 font-black text-xs sm:text-sm transition-colors" href="tel:0465845488">
              <span class="material-symbols-rounded text-primary">call</span>
              04 65 84 54 88
            </a>
            <a class="inline-flex items-center justify-center gap-2 rounded-2xl bg-white hover:bg-slate-50 dark:bg-slate-900 dark:hover:bg-slate-800 border border-slate-200 dark:border-slate-700 px-4 py-3 font-black text-xs sm:text-sm transition-colors" href="mailto:contact@carpartsfrance.fr">
              <span class="material-symbols-rounded text-primary">alternate_email</span>
              contact@carpartsfrance.fr
            </a>
          </div>

          <div class="mt-8 rounded-3xl border border-slate-200/70 dark:border-slate-700 bg-gradient-to-br from-slate-50 to-white dark:from-slate-900 dark:to-slate-900/40 p-6">
            <div class="text-xs font-black uppercase tracking-widest text-slate-400">Choisir</div>
            <div class="mt-3 grid grid-cols-2 gap-3">
              <a class="rounded-2xl border px-4 py-3 text-sm font-black transition-colors <%= mode === 'contact' ? 'border-primary/40 bg-primary/10 text-primary' : 'border-slate-200 dark:border-slate-700 hover:bg-white/70 dark:hover:bg-slate-800' %>" href="/contact">
                Contact
              </a>
              <a class="rounded-2xl border px-4 py-3 text-sm font-black transition-colors <%= mode === 'devis' ? 'border-primary/40 bg-primary/10 text-primary' : 'border-slate-200 dark:border-slate-700 hover:bg-white/70 dark:hover:bg-slate-800' %>" href="/devis">
                Devis
              </a>
            </div>

            <div class="mt-4 text-[11px] text-slate-500 dark:text-slate-400 leading-relaxed">
              Astuce : pour une compatibilité parfaite, indique si possible le VIN (17 caractères) ou l’immatriculation, et/ou la référence (OEM) de la pièce.
            </div>
          </div>
        </div>
      </div>

      <div class="lg:col-span-7">
        <div class="rounded-3xl bg-white dark:bg-surface-dark border border-slate-100 dark:border-slate-800 p-6 sm:p-10 shadow-premium">
          <% if (errorMessage) { %>
            <div class="mb-6 rounded-2xl border border-red-200 bg-red-50 p-5 text-red-900">
              <div class="font-bold">Erreur</div>
              <div class="mt-1 text-sm"><%= errorMessage %></div>
            </div>
          <% } %>

          <% if (successMessage) { %>
            <div class="mb-6 rounded-2xl border border-green-200 bg-green-50 p-5 text-green-900">
              <div class="font-bold">OK</div>
              <div class="mt-1 text-sm"><%= successMessage %></div>
            </div>
          <% } %>

          <form action="<%= mode === 'devis' ? '/devis' : '/contact' %>" class="space-y-5" method="POST">
            <input name="mode" type="hidden" value="<%= mode %>" />
            <input name="website" type="text" value="<%= form && form.website ? form.website : '' %>" tabindex="-1" autocomplete="off" aria-hidden="true" style="position:absolute;left:-10000px;top:auto;width:1px;height:1px;overflow:hidden;" />

            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-semibold text-slate-900 dark:text-slate-200 mb-2" for="firstName">Prénom</label>
                <input class="w-full h-12 px-4 rounded-2xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 focus:ring-primary focus:border-primary outline-none text-sm font-medium placeholder:text-slate-400" id="firstName" name="firstName" placeholder="Votre prénom" type="text" value="<%= form && form.firstName ? form.firstName : '' %>" />
              </div>
              <div>
                <label class="block text-sm font-semibold text-slate-900 dark:text-slate-200 mb-2" for="lastName">Nom</label>
                <input class="w-full h-12 px-4 rounded-2xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 focus:ring-primary focus:border-primary outline-none text-sm font-medium placeholder:text-slate-400" id="lastName" name="lastName" placeholder="Votre nom" type="text" value="<%= form && form.lastName ? form.lastName : '' %>" />
              </div>
            </div>

            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-semibold text-slate-900 dark:text-slate-200 mb-2" for="email">Email</label>
                <input class="w-full h-12 px-4 rounded-2xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 focus:ring-primary focus:border-primary outline-none text-sm font-medium placeholder:text-slate-400" id="email" name="email" placeholder="votre@email.fr" required type="email" value="<%= form && form.email ? form.email : '' %>" />
              </div>
              <div>
                <label class="block text-sm font-semibold text-slate-900 dark:text-slate-200 mb-2" for="phone">Téléphone (optionnel)</label>
                <input class="w-full h-12 px-4 rounded-2xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 focus:ring-primary focus:border-primary outline-none text-sm font-medium placeholder:text-slate-400" id="phone" name="phone" placeholder="Ex : 06 12 34 56 78" type="tel" value="<%= form && form.phone ? form.phone : '' %>" />
              </div>
            </div>

            <% const showQuoteFields = mode === 'devis'; %>

            <% if (showQuoteFields) { %>
              <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                <div>
                  <label class="block text-sm font-semibold text-slate-900 dark:text-slate-200 mb-2" for="vin">VIN (optionnel)</label>
                  <input class="w-full h-12 px-4 rounded-2xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 focus:ring-primary focus:border-primary outline-none text-sm font-medium placeholder:text-slate-400" id="vin" name="vin" placeholder="17 caractères" type="text" value="<%= form && form.vin ? form.vin : '' %>" />
                  <div class="mt-1 text-[11px] text-slate-500">Tu le trouves sur la carte grise (E) ou sur le véhicule.</div>
                </div>
                <div>
                  <label class="block text-sm font-semibold text-slate-900 dark:text-slate-200 mb-2" for="plate">Plaque d’immatriculation (optionnel)</label>
                  <input class="w-full h-12 px-4 rounded-2xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 focus:ring-primary focus:border-primary outline-none text-sm font-medium placeholder:text-slate-400" id="plate" name="plate" placeholder="Ex : AB-123-CD" type="text" value="<%= form && form.plate ? form.plate : '' %>" />
                  <div class="mt-1 text-[11px] text-slate-500">Si tu n’as pas le VIN, l’immatriculation peut aider.</div>
                </div>
              </div>

              <div>
                <label class="block text-sm font-semibold text-slate-900 dark:text-slate-200 mb-2" for="partRef">Référence (OEM / pièce) (optionnel)</label>
                <input class="w-full h-12 px-4 rounded-2xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 focus:ring-primary focus:border-primary outline-none text-sm font-medium placeholder:text-slate-400" id="partRef" name="partRef" placeholder="Ex : 0AM325065S (si vous l’avez)" type="text" value="<%= form && form.partRef ? form.partRef : '' %>" />
              </div>

              <div>
                <label class="block text-sm font-semibold text-slate-900 dark:text-slate-200 mb-2" for="vehicle">Véhicule (optionnel)</label>
                <input class="w-full h-12 px-4 rounded-2xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 focus:ring-primary focus:border-primary outline-none text-sm font-medium placeholder:text-slate-400" id="vehicle" name="vehicle" placeholder="Ex : Golf 7 1.6 TDI 2015" type="text" value="<%= form && form.vehicle ? form.vehicle : '' %>" />
              </div>

              <input name="subject" type="hidden" value="devis" />
            <% } else { %>
              <div>
                <label class="block text-sm font-semibold text-slate-900 dark:text-slate-200 mb-2" for="subject">Sujet</label>
                <select class="w-full h-12 px-4 rounded-2xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 focus:ring-primary focus:border-primary outline-none text-sm font-medium">
                  <option value="question" <%= (form && form.subject === 'question') ? 'selected' : '' %>>Question</option>
                  <option value="compatibilite" <%= (form && form.subject === 'compatibilite') ? 'selected' : '' %>>Compatibilité / Référence</option>
                  <option value="commande" <%= (form && form.subject === 'commande') ? 'selected' : '' %>>Commande / Livraison</option>
                  <option value="autre" <%= (form && form.subject === 'autre') ? 'selected' : '' %>>Autre</option>
                </select>
              </div>
            <% } %>

            <div>
              <label class="block text-sm font-semibold text-slate-900 dark:text-slate-200 mb-2" for="message">Message</label>
              <textarea class="w-full min-h-[160px] px-4 py-3 rounded-2xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 focus:ring-primary focus:border-primary outline-none text-sm font-medium placeholder:text-slate-400" id="message" name="message" placeholder="Explique ton besoin : véhicule, référence, symptôme, numéro OEM…" required><%= form && form.message ? form.message : '' %></textarea>
              <div class="mt-2 text-[11px] text-slate-500">On ne partage jamais ton email. Réponse sous 24h ouvrées en général.</div>
            </div>

            <div class="flex flex-col sm:flex-row gap-3 sm:gap-4">
              <button class="inline-flex items-center justify-center rounded-2xl bg-primary hover:bg-primary/90 text-white py-3 px-6 font-black text-sm shadow-xl shadow-red-500/20 transition-all" type="submit">
                Envoyer
                <span class="material-symbols-outlined ml-2">send</span>
              </button>
              <a class="inline-flex items-center justify-center rounded-2xl bg-white hover:bg-slate-50 dark:bg-slate-900 dark:hover:bg-slate-800 border border-slate-200 dark:border-slate-700 py-3 px-6 font-black text-sm transition-colors" href="/produits">
                Voir le catalogue
                <span class="material-symbols-outlined ml-2">arrow_forward</span>
              </a>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</main>

<%- include('../partials/footer') %>
